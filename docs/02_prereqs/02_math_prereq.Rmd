---
title: "Math Prerequisites"
author: "David Gerard"
date: "`r Sys.Date()`"
output:  
  html_document:
    toc: true
    toc_depth: 4
urlcolor: "blue"
---

```{r setup, include=FALSE}
library(latex2exp)
knitr::opts_chunk$set(echo       = TRUE, 
                      fig.align  = "center")
ggplot2::theme_set(ggplot2::theme_bw() + ggplot2::theme(strip.background = ggplot2::element_rect(fill = "white")))
```

```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy()
```

# Learning Objectives

- Minimum mathematics required to complete this course.
- Summations/averages
- Equations for lines
- Logarithms/exponentials
- Vectors/matrices
- Intuition behind derivatives
- Chapter 3 of [ROS](https://avehtari.github.io/ROS-Examples/)

# Motivation

- Mathematics and simple statistics are the building blocks of linear regression.

- Linear algebra is important for the characterization and interpretation of linear models.

- Log/exponential transformations are important for the practice and interpretation of linear models.

- Calculus is important for estimating the parameters of linear models.

- Here, we will provide a brief mathematical/statistical review.

# Weighted Averages

- Consider the following data on USA, Mexico, and Canada:

    | Label  | Population $N_j$  | Average Age $\bar{y}_j$|
    |--------|-------------------|------------------------|
    | USA    | 310 Million       | 36.8                   |
    | Mexico | 112 Million       | 26.7                   |
    | Canada | 34 Million        | 40.7                   |
    
- What is the average age for these three countries?

- Proportion USA: $\frac{310}{310 + 112 + 34} = 0.68$.

- Proportion Mexico: $\frac{112}{310 + 112 + 34} = 0.25$.

- Proportion Canada: $\frac{34}{310 + 112 + 34} = 0.07$.

- So the USA contributes 68\% of the population, mexico contributes 25\% of the population, and Canada contributes 7\% of the population. To find the overall average age, we calculate:

$$
0.68 \times 36.8 + 0.25 \times 26.7 + 0.07 \times 40.7 = 34.6
$$

- We can equivalently write this as

$$
\frac{310 \times 36.8 + 112 \times 26.7 + 34 \times 40.7}{310 + 112 + 34} = \frac{310}{456}\times 36.8 + \frac{112}{456}\times 26.7 + \frac{34}{456}\times 40.7
$$

- The proportions 0.68, 0.25, and 0.07 are called the **weights**. When the weights sum to one, the overall sumation is called a **weighted average**.

- In **summation notation** (using the capital-sigma), we would write:

    \begin{align}
    \text{weighted average} &= \sum_{j=1}^n w_j y_j\\
    &= w_1y_1 + w_2y_2 + \cdots w_ny_n
    \end{align}
    
    where $w_j$ is the $j$th weight and $y_j$ is the $j$th value.

- What would be an "unweighted" average? This is where each $w_j = \frac{1}{n}$ since

    \begin{align}
    \sum_{j=1}^n w_j y_j &= \sum_{j=1}^n \frac{1}{n} y_j\\
    &= \frac{1}{n}y_1 + \frac{1}{n}y_2 + \cdots + \frac{1}{n}y_n\\
    &= \frac{1}{n}(y_1 +y_2 + \cdots + y_n)\\
    &= \frac{1}{n}\sum_{j=1}^n y_j\\
    &= \bar{y}
    \end{align}
    
- Properties:
    - $\sum_{i=1}^n c a_i = c\sum_{i=1}^na_i$
    - $\sum_{i=1}^n a_i + \sum_{i=1}^nb_i = \sum_{i=1}^n(a_i + b_i)$
    
- **Exercise**: 51\% of Americans are female while 49\% of Americans are male. 79\% of teachers are female while 21\% of teachers are male. Female teachers make on average \$45,865, while male teachers make on average \$49,207. What is the average salary for all teachers?

    ```{block, eval = FALSE, echo = FALSE}
    We need to use the 79\%/21\% split, since we are interested in the population of teachers, not the total population. So we have
    
    0.79 * 45865 + 0.21 * 49207 = 46567
    ```

- **Exercise**: What is $\sum_{i=0}^4 i$?

    ```{block, eval = FALSE, echo = FALSE}
    0 + 1 + 2 + 3 + 4 = 10
    ```

- **Exercise**: Prove that it is not generally true that $\left[\sum_{i=1}^n y_i\right]^2 = \sum_{i=1}^n y_i^2 (*hint*: provide a counterexample).

    ```{block, eval = FALSE, echo = FALSE}
    $(1 + 2)^2 = 3^2 = 9 \neq 5 = 1^2 + 2^2$
    ```

# Lines

- All lines are of the form 
    $$
    y = \beta_0 + \beta_1 x
    $$

- $\beta_1$ is the **slope**, the amount $y$ is larger by when $x$ is 1 unit larger.

- When $\beta_1$ is *negative*, the line slopes *down*.

    ```{r, echo = FALSE, fig.height=3, fig.width=5}
    a <- 0.95
    b <- -0.4
    par(mar=c(3,3,1,1), mgp=c(2,.5,0), tck=-.01)
    plot(c(0,2.2), c(0,a+.2), pch=20, cex=.5, main=TeX("$y = \\beta_0 + \\beta_1 x$ (with $\\beta_1 < 0$)"),
      bty="l", type="n", xlab="x", ylab="y", xaxt="n", yaxt="n", xaxs="i", yaxs="i")
    axis(1, c(0,1,2))
    axis(2, c(a,a+b,a+2*b), c(TeX("$\\beta_0$"),TeX("$\\beta_0+\\beta_1$"),TeX("$\\beta_0+2\\beta_1$")))
    abline(a, b)
    ```

- When $\beta_1$ is *positive*, the line slopes *up*.

    ```{r, echo = FALSE, fig.height=3, fig.width=5}
    a <- 0.15
    b <- 0.4
    par(mar=c(3,3,1,1), mgp=c(2,.5,0), tck=-.01)
    plot(c(0,2.2), c(0,a+2.2*b), pch=20, cex=.5, main=TeX("$y = \\beta_0 + \\beta_1 x$ (with $\\beta_1 > 0$)"),
      bty="l", type="n", xlab="x", ylab="y", xaxt="n", yaxt="n", xaxs="i", yaxs="i")
    axis(1, c(0,1,2))
    axis(2, c(a,a+b,a+2*b), c(TeX("$\\beta_0$"),TeX("$\\beta_0+\\beta_1$"),TeX("$\\beta_0+2\\beta_1$")))
    abline(a, b)
    ```

- When $\beta_1$ is *0*, the line is *horizontal*. In this case, $y$ is the same for every value of $x$ (in other words, $x$ does not affect $y$).

    ```{r, echo = FALSE, fig.height=3, fig.width=5}
    a <- 0.15
    b <- 0
    par(mar=c(3,3,1,1), mgp=c(2,.5,0), tck=-.01)
    plot(c(0, 2), c(a, a), pch=20, cex=.5, main=TeX("$y = \\beta_0 + \\beta_1 x$ (with $\\beta_1 = 0$)"),
      bty="l", type="n", xlab="x", ylab="y", xaxt="n", yaxt="n", xaxs="i", yaxs="i")
    axis(1, c(0,1,2))
    axis(2, c(a), c(TeX("$\\beta_0$")))
    abline(a, b)
    ```
    
- **Example**: 


# Logarithms and Exponentials

# Vectors and Matrices

- A **vector** is a list of numbers.

    $$
    \mathbf{x} = 
    \left(
    \begin{array}{c}
    10\\
    3\\
    5
    \end{array}
    \right)
    $$
    
- In the above vector, the first element is 10, the second is 3, and the third is 5.

- I will generally use bold, lower-case letters to represent vectors.

- A **matrix** is a rectangular array of numbers.

    $$
    \mathbf{A} = 
    \left(
    \begin{array}{cc}
    -1 & 4\\
    11 & -4\\
    2 & 8
    \end{array}
    \right)
    $$

- We index elements by the rows first, then the columns second. For example, in the above matrix, the $(1, 1)$th element is -1, the $(1, 2)$th element is 4, the $(2, 1)$th element is 11, the $(2,2)$th element is -4, the $(3, 1)$th element is 2, and the $(3,2)$th element is 8.

- I will generally use bold, upper-case letters to represent matrices.

- A vector is just a matrix with one column.

- The **transpose** of a matrix/vector swaps the row and column indices.

    \begin{align}
    \mathbf{x}^T &= (10, 3, 5)\\
    \mathbf{A}^T &= 
    \left(
    \begin{array}{ccc}
    -1 & 11 & 2\\
    4 & -4 & 8
    \end{array}
    \right)
    \end{align}
    
- You can multiply two matrices together as long as the left matrix has the same number of columns as the number or rows of the right matrix.


- **Exercise**: Let
    \begin{align}
    \mathbf{X} &= 
    \left(
    \begin{array}{cc}
    3 & -1\\
    1 & -2
    \end{array}
    \right)\\
    \mathbf{Y} &= 
    \left(
    \begin{array}{cc}
    1 & 2\\
    2 & 1
    \end{array}
    \right)
    \end{align}
    Calculate $\mathbf{X}^T\mathbf{Y}$.
    
    ```{block, eval = FALSE, echo = FALSE}
    \begin{align}
    \left(
    \begin{array}{cc}
    5 & 7\\
    -5 & -4
    \end{array}
    \right)
    \end{align}
    ```
    


# Derivatives

